# UFO-srTHG-2019
Spectra.m: plot the measured spectrum of the laser we use, plot the THG spectra of seven different samples, and calculate and plot the corresponding nonlinear susceptibility of each sample. (For Figure 1e, 1f, and 1h-1m.)

Mice_In_Vivo_pseudo_color.m: show image of tumor microenvironment of a formed melanoma tumor on a mouse model with pseudo color, and plot its pseudo-colored image strength distribution of each channel. (For Figure 2b and 2c.)

srTHGM.m: program for calculating saturation oxygenation of in vivo red blood cells for mice and human, based on the calculation result of calibration from ex vivo red blood cells and collagen of mice and human. (Figure 2e, 2g, 2i, 2k, 2m, 2o and Supplementary Figure .)


## Instructions for programs

### System requirements

software: MATLAB,R2018b,64-bit  
computer system: Windows 10 Enterprise,x64  
No required non-standard hardware  

### Installation guide

For MATLAB installation instruction and typical install time:  
Please refer to your software provider or The MathWorks, Inc., Massachusetts, USA.  
For this code:  
Simply download the file (including codes and demo data) to your computer. Typical time: less than 3 minutes.  

### Demo and Instruction for Use

#### Instructions to run on data

#### For “Spectra.m”:
(i) First download “ Spectra ” file, which includes demo data and codes.  
(ii) Start MATLAB and run " Spectra.m ".  
(iii) You will get Figure 1e, and 1g-1l.  

#### For “Mice_In_Vivo_pseudo_color.m”:
(i) First download “ Mice_in_vivo_pseudo_color ” file, which includes demo data and codes.  
(ii) Start MATLAB and run " Mice_In_Vivo_pseudo_color.m ".  
(iii) You will get Figure 2b and 2c.  

#### For “srTHGM.m”:
(i) First download “ srTHGM ” file, which includes demo data and codes.  
(ii) Start MATLAB and run " srTHGM.m ".  
(iii) When asked the demo data, ‘mice’, ‘human’ or ‘all’, enter the number of the part you want to analyze.  
(iv) If you choose ‘mice’, you will get Figure 2e, 2i, 2m and Supplementary Figure ;  
if you choose ‘human’, you will get Figure 2g, 2k, 2o and Supplementary Figure;   
if you choose ‘all’, you will get Figure 2e, 2g, 2i, 2k, 2m, 2o and Supplementary Figure .  

#### Expected output: As indicated in Instruction

#### Expected run time for demo on a "normal" desktop computer
It takes less than 2 minutes for each code running.
